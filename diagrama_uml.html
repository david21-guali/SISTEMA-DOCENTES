<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagrama de Clases UML (Modelos + Pivotes) - Sistema Docentes</title>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: { useMaxWidth: false },
        });
    </script>
    <style>
        body {
            font-family: sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            overflow: hidden;
        }

        #controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            display: flex;
            gap: 10px;
        }

        button {
            padding: 8px 12px;
            font-size: 16px;
            cursor: pointer;
            background: #17a2b8;
            /* Cyan for Pivot View */
            color: white;
            border: none;
            border-radius: 4px;
        }

        button:hover {
            background: #138496;
        }

        #container {
            width: 100vw;
            height: 100vh;
            overflow: auto;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 50px;
            box-sizing: border-box;
        }

        .mermaid {
            background: white;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            transform-origin: top center;
            transition: transform 0.2s ease;
        }
    </style>
</head>

<body>
    <div id="controls">
        <button onclick="zoomIn()">Zoom +</button>
        <button onclick="zoomOut()">Zoom -</button>
        <button onclick="resetZoom()">Restaurar</button>
    </div>

    <div id="container">
        <div class="mermaid" id="mermaidGraph">
            classDiagram
            note "Sistema de Gestión Docente - Modelos y Tablas Intermedias (Pivotes)"

            %% =======================
            %% CLASES (Modelos App/Models)
            %% =======================
            class User {
            +name
            +email
            +projects()
            }

            class Role {
            +name
            +guard_name
            }

            class Profile {
            +position
            +phone
            }

            class Project {
            +title
            +status
            +team()
            +tasks()
            }

            class Task {
            +title
            +status
            +assignees()
            }

            class Meeting {
            +title
            +scheduled_at
            }

            class Resource {
            +name
            +unit_cost
            }

            class Innovation {
            +title
            +status
            }

            class InnovationType {
            +name
            }

            %% =======================
            %% CLASES INTERMEDIAS (PIVOTES)
            %% =======================
            class ProjectUser_Pivot {
            <<Pivote>>
                +project_id
                +user_id
                +role
                }

                class TaskUser_Pivot {
                <<Pivote>>
                    +task_id
                    +user_id
                    }

                    class MeetingUser_Pivot {
                    <<Pivote>>
                        +meeting_id
                        +user_id
                        +attendance
                        }

                        class ProjectResource_Pivot {
                        <<Pivote>>
                            +project_id
                            +resource_id
                            +quantity
                            }

                            class ModelHasRoles_Pivot {
                            <<Spatie>>
                                +role_id
                                +model_id
                                }

                                %% =======================
                                %% RELACIONES
                                %% =======================

                                %% Relación: Usuarios y Roles
                                User ..> ModelHasRoles_Pivot
                                Role ..> ModelHasRoles_Pivot

                                %% Relación: Equipo de Proyecto
                                Project ..> ProjectUser_Pivot
                                User ..> ProjectUser_Pivot
                                note on ProjectUser_Pivot: "Relación Many-to-Many\n(Miembros del Equipo)"

                                %% Relación: Asignación de Tareas
                                Project "1" *-- "*" Task
                                Task ..> TaskUser_Pivot
                                User ..> TaskUser_Pivot
                                note on TaskUser_Pivot: "Relación Many-to-Many\n(Responsables)"

                                %% Relación: Asistencia a Reuniones
                                Project "1" o-- "*" Meeting
                                Meeting ..> MeetingUser_Pivot
                                User ..> MeetingUser_Pivot

                                %% Relación: Recursos del Proyecto
                                Project ..> ProjectResource_Pivot
                                Resource ..> ProjectResource_Pivot

                                %% Otras Relaciones Directas
                                User "1" *-- "1" Profile : has
                                User --> Innovation : proposes
                                Innovation --> InnovationType : type
        </div>
    </div>

    <script>
        let currentZoom = 1;
        const graph = document.getElementById('mermaidGraph');

        function zoomIn() {
            currentZoom += 0.2;
            applyZoom();
        }

        function zoomOut() {
            if (currentZoom > 0.4) {
                currentZoom -= 0.2;
                applyZoom();
            }
        }

        function resetZoom() {
            currentZoom = 1;
            applyZoom();
        }

        function applyZoom() {
            graph.style.transform = `scale(${currentZoom})`;
            const container = document.getElementById('container');
            if (currentZoom > 1) {
                graph.style.margin = `${(currentZoom - 1) * 200}px`;
            } else {
                graph.style.margin = '0';
            }
        }
    </script>
</body>

</html>